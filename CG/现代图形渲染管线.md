### 现代图形渲染管线
#### 现代图形渲染管线
说在前面，渲染管线细分有很多说法，其实总的来说可以总结为四个过程：应用程序过程、几何处理过程、光栅化过程、像素处理过程。
- **顶点数据（Vertex Data）** ：送入渲染管线的数据，包括顶点坐标、纹理坐标、顶点法线、顶点颜色等顶点属性。还有为了让OpenGL明白顶点数据构成的是什么图元，需要在绘制指令中传递对应的图元信息。常见的包括点(GL_POINTS)、线(GL_LINES)、线条(GL_LINE_STRIP)、三角面(GL_TRIANGLES)。
- **顶点着色器（Vertex Shader）**: 顶点着色器主要是坐标系统变换（投影变换到裁剪空间为止）。
- **形状(图元)装配(Shape Assembly)** ：将顶点着色器输出的顶点组装成顶点数据中要求的图元形状，如三角面等等。
- **曲面细分（Tessellation）** ：渲染管线可选的一个阶段。曲面细分是利用镶嵌化处理技术对三角面进行细分，以此来增加物体表面的三角面数量，实现细节层次的机制，使得离摄像机越近的物体具有更加丰富的细节，远离的细节较少。它由外壳着色器（Hull Shader）、镶嵌器（Tessellator）和域着色器（Domain Shader）构成。其中外壳着色器和域着色器是可编程的，镶嵌器是有硬件管理的。OpenGL4.x才有的新特性，故可能有的较老的体系中没有讲。DirectX中一直都有。
- **几何着色器（Geometry Shader）**: 渲染管线的可选阶段。它把图元形式的一系列顶点集合作为输入，通过产生新顶点构造出新的图元来生成其他形状（扩展多边形的感觉）。
- **primitive setup** ：该阶段直接由硬件完成，是光栅化前的准备阶段，进行裁剪和背面剔除，以减少光栅化的图元数量，加速渲染过程。还会进行屏幕映射的操作，即透视除法和视口变换。
- **光栅化（Rasterization）** ：将物体坐标变换到了窗口坐标，光栅化是个离散化的过程，将3D连续的物体转化为离散屏幕像素点的过程。需要判断某像素和图形面片的内外部关系。
- **片段着色器(Fragment Shader)** :片段着色器在DirectX中称为像素着色器。用来决定屏幕上像素的最终颜色。这个阶段会进行光照计算以及阴影处理，是渲染管线高级效果产生的地方。
- **测试混合阶段** ：管线的最后一个阶段是测试混合阶段。测试包括 **裁切测试、Alpha测试、模板测试和深度测试** 。没有经过测试的片段会被丢弃，不需要经过混合阶段。
混合阶段有，**Alpha混合** 可以根据片段的alpha值进行混合，用来产生半透明的效果。Alpha表示的是物体的不透明度，因此alpha=1表示完全不透明，alpha=0表示完全透明，测试混合阶段虽然不是可编程阶段，但是外面可以通过OpenGL提供的接口进行配置，定制混合和测试的方式。
半透明的物体绘制需要遵循画家算法，由远到近进行绘制，因为半透明的混合跟物体的顺序有严格的对应关系。一般会使用 **顺序无关的半透明渲染技术(Order-independent transparency, OIT)** 。
#### 延迟渲染（半透明渲染、反混淆）
#### texture map/shadow map/纹理烘培
#### 贝塞尔曲线
#### 四元素（万向节死锁）
#### 物理引擎（包围盒）
#### 网络模块同步
